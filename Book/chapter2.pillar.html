<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8">
    <title>{Modelling Infectious Diseases with Kendrick}</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">

    <!-- Highlight js -->
    <link rel="stylesheet" href="../support/html/highlightjs/styles/default.css">
    <link rel="stylesheet" href="../support/html/css/highlight-commands.css">
    <script src="../support/html/highlightjs/highlight.pack.js"></script>
    <script src="../support/html/js/highlight-commands.js"></script>

    <!-- Bootstrap -->
    <link href="../support/html/css/bootstrap.min.css" rel="stylesheet">
    <link href="../support/html/css/bootstrap-theme.min.css" rel="stylesheet">
    <style>
        .container { max-width: 55em; }
    </style>

    <!-- HTML5 Shim and Respond.js IE8 support of HTML5 elements and media queries -->
    <!-- WARNING: Respond.js doesn't work if you view the page via file:// -->
    <!--[if lt IE 9]>
      <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
      <script src="https://oss.maxcdn.com/libs/respond.js/1.3.0/respond.min.js"></script>
    <![endif]-->
  </head>
  <body>

    <div class="container text-justify">
      <h2> Introduction to Simple Epidemic Model</h2><a id=" Introduction to Simple Epidemic Model"></a>
<h3>1.  Simple SIR (without births and deaths)</h3><a id=" Simple SIR (without births and deaths)"></a>
<p>Program 2.1 is a simple SIR model (page 19 of the book). These are the equations and the code of the model:</p>
<h4>1.1.  Equations</h4><a id=" Equations"></a>
<h4>1.2.  Pharo code</h4><a id=" Pharo code"></a><p><figure><pre><code class="smalltalk">|solver system dt beta gamma values stepper diag colors maxTime|
dt := 1.0.
beta := 1.4247.
gamma := 0.14286.
maxTime := 70.0.
system := ExplicitSystem block: [ :x :t| |c|
     c := Array new: 3.
     c at: 1 put: (beta negated) * (x at: 1) * (x at: 2).
     c at: 2 put: (beta * (x at: 1) * (x at: 2)) - (gamma * (x at: 2)).
     c at: 3 put: gamma * (x at: 2).
     c
     ].
stepper := RungeKuttaStepper onSystem: system.
solver := (ExplicitSolver new) stepper: stepper; system: system; dt: dt.
state := { 1-1e-6. 1e-6. 0}.
values := (0.0 to: maxTime by: dt) collect: [ :t| |state| state := stepper doStep: state
                                                          time: t stepSize: dt ].
diag := OrderedCollection new.
colors := Array with: Color blue with: Color red with: Color green.
1 to: 3 do: [ :i|
    diag add:
        ((GETLineDiagram new)
            models: (1 to: maxTime+1 by: 1);
            y: [ :x| (values at: x) at: i ];
            color: (colors at: i))
     ].
builder := (GETDiagramBuilder new).
builder compositeDiagram
    xAxisLabel: 'Time in days';
    yAxisLabel: 'Number of Individuals';
    regularAxis;
    diagrams: diag.
builder open.</code></pre><figcaption></figcaption></figure></p>
<h3>2.  SIR model with births and deaths</h3><a id=" SIR model with births and deaths"></a><h4>2.1.  Equations</h4><a id=" Equations"></a>
<h4>2.2.  Pharo code</h4><a id=" Pharo code"></a><p><figure><pre><code class="smalltalk">|solver system dt beta gamma values stepper diag mu colors maxTime|
dt := 1.0.
mu := 1/(70*365.0).
beta := 520/365.0.
gamma := 1/7.0.
maxTime := 60*365.
system := ExplicitSystem block: [ :x :t| |c|
     c := Array new: 3.
     c at: 1 put: mu - (beta  * (x at: 1) * (x at: 2)) - (mu * (x at:1)).
     c at: 2 put: (beta * (x at: 1) * (x at: 2)) - (gamma * (x at: 2)) - (mu * (x at:2)).
     c at: 3 put: (gamma * (x at: 2)) - (mu * (x at: 2)).
     c
     ].

stepper := RungeKuttaStepper onSystem: system.
solver := (ExplicitSolver new) stepper: stepper; system: system; dt: dt.
state := { 0.1. 1e-4. 1-0.1-1e-4}.
values := (0.0 to: maxTime by: dt) collect: [ :t| |state| state := stepper doStep: state
                                                          time: t stepSize: dt ].
diag := OrderedCollection new.
colors := Array with: Color blue with: Color red with: Color green.
1 to: 3 do: [ :i|
    diag add:
        ((GETLineDiagram new)
            models: (1 to: maxTime+1 by: 1);
            y: [ :x| (values at: x) at: i ];
            color: (colors at: i))
     ].
builder := (GETDiagramBuilder new).
builder compositeDiagram
    xAxisLabel: 'Time in days';
    yAxisLabel: 'Number of Individuals';
    regularAxis;
    diagrams: diag.
builder open.</code></pre><figcaption></figcaption></figure></p>
<h3>3.  SIR model with disease induced mortality and density dependent transmission</h3><a id=" SIR model with disease induced mortality and density dependent transmission"></a><h4>3.1.  Equations</h4><a id=" Equations"></a>
<h3>4.  SIR model, disease induced mortality and frequency dependent transmission</h3><a id=" SIR model, disease induced mortality and frequency dependent transmission"></a><h4>4.1.  Equations</h4><a id=" Equations"></a><h4>4.2.  Pharo code</h4><a id=" Pharo code"></a>
<h3>5.  SIS model without births or deaths</h3><a id=" SIS model without births or deaths"></a><h4>5.1. Equations</h4><a id="Equations"></a>
<h3>6.  SEIR model with births and deaths</h3><a id=" SEIR model with births and deaths"></a><h3>7.  SIR with a carrier state</h3><a id=" SIR with a carrier state"></a>
    </div>

    <!-- jQuery (necessary for Bootstrap's JavaScript plugins) -->
    <script src="https://code.jquery.com/jquery.js"></script>
    <!-- Include all compiled plugins (below), or include individual files as needed -->
    <script src="../support/html/js/bootstrap.min.js"></script>

    <!-- Syntax highlighting of code blocks -->
    <script>hljs.initHighlightingOnLoad();</script>

  </body>
</html>
